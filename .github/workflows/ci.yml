name: macchina.io-ci
on: [push]
jobs:
  ubuntu-2204-gcc-make:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v3
      - run: sudo apt update && sudo apt install libssl-dev python-is-python3
      - run: make -s -j`nproc` DEFAULT_TARGET=shared_release

  macos-clang-make:
    runs-on: macos-12
    steps:
      - uses: actions/checkout@v3
      - run: brew install openssl@3 python@3.9
      - run: PATH=/usr/local/opt/python@3.9/libexec/bin:$PATH make -s -j`sysctl -n hw.ncpu` DEFAULT_TARGET=shared_release
